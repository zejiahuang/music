- name: Clean source files from invalid characters
  run: |
    # 清理所有源文件中的非法字符
    $files = Get-ChildItem -Recurse -Include *.h, *.cpp -File
    foreach ($file in $files) {
        $content = Get-Content -Path $file.FullName -Raw -Encoding UTF8
        # 移除所有非ASCII字符
        $cleanContent = $content -replace '[^\x00-\x7F]', ''
        if ($content -ne $cleanContent) {
            Write-Host "Cleaning invalid characters in $($file.FullName)"
            Set-Content -Path $file.FullName -Value $cleanContent -NoNewline -Encoding UTF8
        }
    }
